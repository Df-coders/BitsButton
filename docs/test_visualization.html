<!DOCTYPE html>
<html>
<head>
    <title>BitsButton 状态机流程图 - 测试版</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.0.0/dist/mermaid.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .diagram { margin: 20px 0; border: 1px solid #ccc; padding: 10px; }
        .description { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <h1>BitsButton 状态机流程图（修正版）</h1>
    
    <h2>测试：典型按键模式的位序列编码</h2>
    <div class="diagram">
        <div class="mermaid">
            flowchart TD
                A[初始状态: 0b0] --> B1[按下: 0b1]
                A --> C1[按下: 0b1]
                A --> D1[按下: 0b1]
                
                B1 --> B2[释放: 0b10]
                B2 --> B3[单击完成: 0b10]
                
                C1 --> C2[释放: 0b10]
                C2 --> C3[窗口内再按: 0b101]
                C3 --> C4[再释放: 0b1010]
                C4 --> C5[双击完成: 0b1010]
                
                D1 --> D2[长按检测: 0b11]
                D2 --> D3[释放: 0b110]
                D3 --> D4[长按完成: 0b110]
                
                style B3 fill:#e1f5fe
                style C5 fill:#f3e5f5
                style D4 fill:#e8f5e8
        </div>
    </div>

    <div class="description">
        <h3>修正说明</h3>
        <ul>
            <li>✅ 使用 flowchart TD 替代有问题的 gitgraph 语法</li>
            <li>✅ 修正了实际编码值（去掉了错误的前导0位）</li>
            <li>✅ 使用颜色区分不同的按键模式</li>
            <li>✅ 兼容 Mermaid v11.x 语法</li>
        </ul>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: { useMaxWidth: true },
            securityLevel: 'loose'
        });
    </script>
</body>
</html>